<!DOCTYPE html>

{% extends 'base.html' %}

{% load staticfiles %}

{% block body_block %}
<div class="page-header">
    <h2>{% load i18n %}{% trans "Register for a bike" %}</h2>
    <h3>{% trans "Currently, entering a phone number is not supported!" %}</h3>
</div>
<form id="nameForm" method="POST" class="post-form">
    {% csrf_token %}
    <div class="form-group row">
        <label class="col-xs-3 col-md-2 control-label">
            {% trans "Identification" %}
        </label>
        <div class="col-xs-9 col-md-4">
            <input class="form-control" name="first_name" type="text"
                   maxlength="100" placeholder="first name" required/>
        </div>
        <div class="col-xs-12" style="height:10px;"></div>
        <div class="col-xs-offset-3 col-xs-9 col-md-offset-2 col-md-4">
            <input class="form-control" name="last_name" type="text"
                   maxlength="100" placeholder="last name" required/>
        </div>
        <div class="col-xs-12" style="height:15px;"></div>
        <div class="col-xs-offset-3 col-xs-7 col-md-offset-2 col-md-4">
            <div class="input-group">
                <input type='text' id='datepicker' name="date_of_birth"
                class="form-control" placeholder='date of birth' required/>
                <label for='datepicker' class="input-group-addon btn">
                    <span class="glyphicon glyphicon-calendar"></span>
                </label>
            </div>
        </div>
        <div class="col-xs-12" style="height:10px;"></div>
    </div>
    <div class="form-group row">
        <div class="col-xs-3 col-md-2 control-label">
            <label for="id_email">
                {% trans "Contact information" %}
            </label>
        </div>
        <div class="col-xs-9 col-md-4">
            <p class="required">
                <input class="form-control contact-group" id="id_email"
                       name="email" type="email"
                       placeholder="email address"/>
            </p>
        </div>
    </div>
    <div class="form-group row">
        <div class="col-xs-offset-3 col-xs-9 col-md-offset-2 col-md-4">
            <p class="required">
                <input class="form-control contact-group" id="id_phone"
                       name="phone" type="tel"
                       placeholder="mobile phone number"/>
            </p>
        </div>
    </div>
    <div class="form-group row">
        <div class="col-xs-3 col-md-2 control-label">
            <label for="id_additional">
                {% trans "Bicycle kind" %}
            </label>
        </div>
        <div class="col-xs-7 col-md-3 selectContainer">
            <select class="form-control" name="bicycle_kind">
            {% for value, choice in choices %}
                <option value="{{ value }}">{{ choice }}</option>
            {% endfor %}
            </select>
        </div>
    </div>

     <div class="form-group row">
        <label class="col-xs-3 col-md-2 control-label">
            {% trans "Terms of use" %}
        </label>
        <div class="col-xs-9 col-md-7">
            <div style="border: 1px solid #e5e4e4; height: 200px;
            overflow: auto; padding: 10px;">
                <p>Our terms of use are the following.</p>
                <li>You can only buy only one bike per person.</li>
                <li>Please do not register twice.</li>
                <li>If you want a bike for your children, please also register them.</li>
                <li>We do not sell new bikes.</li>
                <li>All bikes are donated and used.</li>
                <li>We only sell roadworthy bikes.</li>
                <li>You can resell your bike to us, if you do not need it anymore.</li>
                <li>Our bikes always need repair work. Please bring some time and help us repairing your bike.</li>
            </div>
        </div>
    </div>

    <div class="form-group row">
        <div class="col-xs-offset-3 col-xs-9 col-md-offset-2 col-md-4">
            <div class="checkbox">
                <label>
                    <input type="checkbox" name="agree" value="agree" required/>
                    {% trans "Agree with the terms and conditions" %}
                </label>
            </div>
        </div>
    </div>

    
    <div class="form-group row">
        <div class="col-xs-offset-3 col-xs-9 col-md-offset-2 col-md-3">
            <button type="submit" class="btn btn-lg btn-info btn-block">
                {% trans "Submit" %}
            </button>
        </div>
    </div>
</form>
{% endblock %}

{% block script_block %}
<script>
$(function () {
    $('#datepicker').datepicker();
});

$(document).ready(function() {
    var nameIndex = 0;
    var MAX_OPTIONS = 4;

    // Validate form
    $('#nameForm').validate({
        rules: {
            phone: {
                require_from_group: [1, ".contact-group"]
            },
            email: {
                require_from_group: [1, ".contact-group"]
            }
        }
    })

    $('#nameForm')
        // Add button click handler
        .on('click', '.addButton', function() {
            nameIndex++;
            var $template = $('#nameTemplate'),
                $clone    = $template
                                .clone()
                                .removeClass('hide')
                                .removeAttr('id')
                                .attr('data-name-index', nameIndex)
                                .insertBefore($template);

            // Update the name attributes
            $clone
                .find('[name="first_name"]').attr('name', 'first_name_' + nameIndex).end()
                .find('[name="last_name"]').attr('name', 'last_name_' + nameIndex).end();


            if (nameIndex >= MAX_OPTIONS) {
                $('#nameForm').find('.addButton').attr('disabled', 'disabled');
            }
        })

        // Remove button click handler
        .on('click', '.removeButton', function() {
            nameIndex--;
            var $row  = $(this).parents('.form-group');

            // Remove element containing the fields
            $row.remove();

            if (nameIndex < MAX_OPTIONS) {
                $('#nameForm').find('.addButton').removeAttr('disabled');
            }
        });
});
</script>
{% endblock %}
